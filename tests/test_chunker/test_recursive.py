from pprint import pp

from core.chunker.recursive import RecursiveChunker

TEST_STR = """
深度学习：人工智能的革命性突破。深度学习是机器学习的一个分支，基于人工神经网络，特别是深层神经网络进行学习和模式识别。它模仿人脑的神经元连接方式，通过多层网络结构，能够自动学习数据的层次化特征表示。近年来，深度学习在计算机视觉、自然语言处理、语音识别等领域取得了突破性进展。
神经网络的基础架构。深度学习的核心是神经网络，由输入层、隐藏层和输出层组成。每个神经元通过权重连接到其他神经元，接收输入信号，经过激活函数处理后产生输出。反向传播算法是训练神经网络的关键技术，通过计算损失函数的梯度，逐层更新网络参数，使模型不断优化。
卷积神经网络的图像革命。在计算机视觉领域，卷积神经网络（CNN）是最成功的深度学习架构之一。CNN通过卷积层、池化层和全连接层的组合，能够有效提取图像的空间特征。它在图像分类、物体检测、人脸识别等任务上表现卓越，甚至在某些任务上超越了人类的表现。
循环神经网络处理序列数据。对于时序数据和自然语言，循环神经网络（RNN）及其变体LSTM和GRU表现出色。这些网络能够记住之前的信息，处理变长序列，在机器翻译、语音识别、文本生成等任务中发挥重要作用。Transformer架构的出现进一步推动了自然语言处理的发展。
生成对抗网络的创新应用。生成对抗网络（GAN）由生成器和判别器组成，通过对抗训练产生高质量的合成数据。GAN在图像生成、风格转换、数据增强等方面展现出强大能力，为创意AI和艺术创作开辟了新的可能性。
深度学习的挑战与未来。尽管深度学习取得了巨大成功，但仍面临数据需求量大、可解释性差、计算资源消耗高等挑战。未来的发展方向包括小样本学习、可解释AI、边缘计算优化等，这些将进一步推动人工智能技术的普及和应用。
"""


def test_recursive_chunker():
    chunker = RecursiveChunker(chunk_size=20)
    result: list[str] | list[list[str]] = chunker.chunk(TEST_STR)

    pp("-" * 20 + "recursive chunker result:" + "-" * 20)
    pp(result)
    pp("-" * 20 + "recursive chunker finish" + "-" * 20)

    assert result is not None
    assert isinstance(result, list)
    assert len(result) > 1
