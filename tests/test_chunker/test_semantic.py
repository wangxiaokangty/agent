from pprint import pp

from core.chunker.semantic import SemanticChunker

TEST_STR = """
光合作用是地球上最重要的化学反应之一，它是植物、藻类和某些细菌利用光能，将二氧化碳和水转化为富能有机物（主要是葡萄糖），并释放出氧气的过程。这个过程不仅为几乎所有生命提供了食物来源，也为我们创造了赖以生存的含氧大气。
深入到细胞层面，光合作用主要在叶绿体中进行。整个过程分为两个主要阶段：光反应和暗反应（也称碳反应）。在光反应阶段，叶绿素等光合色素吸收光能，将水分解成氧气、质子和电子，并将光能转化为化学能储存在ATP和NADPH这两种分子中。这个阶段必须有光才能进行。随后，在暗反应阶段，利用光反应产生的ATP和NADPH，在一种叫做卡尔文循环的系列反应中，将二氧化碳固定并合成为葡萄糖。这个阶段不直接需要光，但依赖于光反应的产物。
从生态学的角度看，光合作用的影响是全球性的和深远的。它构成了地球上绝大多数食物链的基础，所有食草动物的能量最终都来源于植物通过光合作用固定的太阳能。同时，每年通过光合作用消耗的大量二氧化碳，对缓解全球温室效应起到了至关重要的作用。可以说，没有光合作用，地球的生态系统和气候环境将是完全不同的景象。
苹果公司的故事始于1976年，在加州一个不起眼的车库里，史蒂夫·乔布斯和史蒂夫·沃兹尼亚克共同创立了这家公司。他们的第一款产品是Apple I，一款主要面向电子爱好者的电脑主板。随后推出的Apple II取得了巨大的商业成功，它拥有彩色的图形界面和开放的架构，真正开启了个人电脑革命的浪幕，并使苹果迅速成为一家价值数十亿美元的公司。这个初创时期的苹果，充满了理想主义和工程师文化。
进入80年代，苹果面临着来自IBM等巨头的激烈竞争。为了应对挑战，乔布斯主导开发了具有革命性图形用户界面（GUI）和鼠标的Macintosh电脑。1984年，苹果在超级碗期间投放了那则著名的广告，将Macintosh定位为挑战思想禁锢的工具。尽管Macintosh在技术上是开创性的，但其高昂的价格和封闭的生态系统限制了市场份额。随后，由于公司内部的权力斗争，乔布斯于1985年被迫离开了自己亲手创立的公司。
乔布斯离开后，苹果公司进入了一段漫长的迷失期。公司产品线混乱，创新乏力，市场份额持续下滑，一度濒临破产。直到1997年，苹果公司收购了乔布斯创立的NeXT公司，乔布斯才得以戏剧性地回归。他回归后迅速进行了大刀阔斧的改革，砍掉了冗余的产品线，并推出了“Think Different”广告活动，重新点燃了品牌的激情。1998年发布的iMac G3，以其多彩的半透明外壳和一体化设计，震惊了整个行业，标志着苹果复兴的开始。
21世纪初，苹果的创新进入了快车道，彻底改变了多个行业。2001年，iPod的推出颠覆了音乐产业。2007年，iPhone的发布则重新定义了手机，开启了移动互联网时代，并成为公司历史上最成功的产品。紧接着，2010年iPad的问世开创了平板电脑市场。这一系列基于iOS生态系统的产品，构建了强大的护城河，将苹果推向了全球市值最高公司的宝座。
"""


def test_semantic_chunker():
    chunker = SemanticChunker()
    result: list[str] | list[list[str]] = chunker.chunk(TEST_STR)

    pp("-" * 20 + "semantic chunker result:" + "-" * 20)
    pp(result)
    pp("-" * 20 + "semantic chunker finish" + "-" * 20)

    assert result is not None
    assert isinstance(result, list)
